<!DOCTYPE html>
<html lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta charset="utf-8">
  <!-- Title and other stuffs -->
  <title>Dashboard - MacAdmin</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="keywords" content="">
  <meta name="author" content="">


  <!-- Stylesheets -->
  <link href="css/bootstrap.min.css" rel="stylesheet">
  <!-- Font awesome icon -->
  <link rel="stylesheet" href="css/font-awesome.min.css"> 
  <!-- jQuery UI -->
  <link rel="stylesheet" href="css/jquery-ui.css"> 
  <!-- Calendar -->
  <link rel="stylesheet" href="css/fullcalendar.css">
  <!-- prettyPhoto -->
  <link rel="stylesheet" href="css/prettyPhoto.css">  
  <!-- Star rating -->
  <link rel="stylesheet" href="css/rateit.css">
  <!-- Date picker -->
  <link rel="stylesheet" href="css/bootstrap-datetimepicker.min.css">
  <!-- CLEditor -->
  <link rel="stylesheet" href="css/jquery.cleditor.css"> 
  <!-- Data tables -->
  <link rel="stylesheet" href="css/jquery.dataTables.css"> 
  <!-- Bootstrap toggle -->
  <link rel="stylesheet" href="css/jquery.onoff.css">
  <!-- Main stylesheet -->
  <link href="css/style.css" rel="stylesheet">
  <!-- Widgets stylesheet -->
  <link href="css/widgets.css" rel="stylesheet">   
  
  <script src="js/respond.min.js"></script>
  
  <!--[if lt IE 9]>
  <script src="js/html5shiv.js"></script>
  <![endif]-->

  <!-- Favicon -->
  <link rel="shortcut icon" href="img/favicon/favicon.png">

  <style>
  .navbar-nav a {
    cursor: pointer;
  }
  </style>
</head>

<body>

<div class="navbar navbar-fixed-top bs-docs-nav" role="banner">
  
    <div class="conjtainer">
      <!-- Menu button for smallar screens -->
      <div class="navbar-header">
		  <button class="navbar-toggle btn-navbar" type="button" data-toggle="collapse" data-target=".bs-navbar-collapse">
			<span>Menu</span>
		  </button>
		  <!-- Site name for smallar screens -->
		  <img class="" src="img/logo.png" style="margin-top:5px;"></img>
		</div>
      
      

      <!-- Navigation starts -->
      <nav class="collapse navbar-collapse bs-navbar-collapse" role="navigation">         

        <ul class="nav navbar-nav">  

          <!-- Upload to server link. Class "dropdown-big" creates big dropdown -->
          <li class="dropdown dropdown-big">
            <a href="#"class="dropdown-toggle" data-toggle="dropdown"><span class="label label-success"><i class="fa fa-wifi"></i></span> Quản lý đo xa</a>
            <!-- Dropdown -->
            <ul class="dropdown-menu">
              <li>
                <!-- Using "icon-spin" class to rotate icon. -->
                <p><span class="label label-info" ><i class="fa fa-cloud"></i></span> <a href="index.php?page=doxa">Các điểm trên hệ thống đo xa</a></p>
                <hr />
				<p><span class="label label-warning" ><i class="fa fa-cloud"></i></span> <a class="doxa"href="#">Các thông báo cảnh báo</a></p>
                <hr />
                <!-- Dropdown menu footer -->
                <div class="drop-foot">
                  <a href="#">View All</a>
                </div>

              </li>
            </ul>          </li>

          <!-- Sync to server link -->
          <li class="dropdown dropdown-big">
            <a  class="dropdown-toggle" data-toggle="dropdown" ><span class="label label-danger"><i class="fa fa-refresh"></i></span> Thống kê vận hành</a>
            <!-- Dropdown -->
            <ul class="dropdown-menu">
              <li>
                <!-- Using "icon-spin" class to rotate icon. -->
                <p><span class="label label-info" ><i class="fa fa-cloud"></i></span> <a class="doxa manager_instant_meter">Thông số vận hành (15 phút)</a></p>
                <hr />
				<p><span class="label label-warning" ><i class="fa fa-cloud"></i></span> <a class="doxa manager_profile_meter">Thông số phụ tải(30 phút)</a></p>
                <hr />
                <p><span class="label label-warning" ><i class="fa fa-cloud"></i></span><a class="doxa manager_current_meter"> Thông số chỉ số (60 phút) </a></p>				
                <hr />

                <!-- Dropdown menu footer -->
                <div class="drop-foot">
                  <a href="#">View All</a>
                </div>

              </li>
            </ul>
          </li>
		  <!-- Sync to server link -->
          <li class="dropdown dropdown-big">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown"><span class="label label-danger"><i class="fa fa-refresh"></i></span> Chỉ số đo lường</a>
            <!-- Dropdown -->
            <ul class="dropdown-menu">
              <li>
                <!-- Using "icon-spin" class to rotate icon. -->
                <p><span class="label label-info" ><i class="fa fa-cloud"></i></span><a class="doxa manager_h1_meter"> Chỉ số chốt tháng </a> </p>
                <hr />
				<p><span class="label label-warning"><i class="fa fa-cloud"></i></span><a class="doxa manager_sum_h1_meter"> Tổng hợp </a></p>
                <hr />
				<p><span class="label label-warning"><i class="fa fa-cloud"></i></span><a class="doxa manager_price"> Giá mua bán điện </a></p>
                <hr />
                <!-- Dropdown menu footer -->
                <div class="drop-foot">
                  <a href="#">View All</a>
                </div>

              </li>
            </ul>
          </li>
		  <!-- Sync to server link -->
          <li class="dropdown dropdown-big">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown"><span class="label label-danger"><i class="fa fa-folder-open-o"></i></span> Quản lý nhà máy</a>
            <!-- Dropdown -->
            <ul class="dropdown-menu">
              <li>
                <!-- Using "icon-spin" class to rotate icon. -->
                <a style="padding:5px 0px;" class="qlnm manager_dataipp"><span class="label label-sub-3"  ><i class="fa fa-file-text-o"></i></span> Quản lý thông tin nhà máy</a>
                <hr />
                <a style="padding: 5px 0px;" class="qlnm manager_equipmentipp" ><span class="label label-sub-3"><i class="fa fa-file-text-o"></i></span> Quản lý thiết bị đo lường</a>
                <hr />
        <a style="padding:5px 0px;" class="qlnm manager_fileipp"><span class="label label-sub-3"><i class="fa fa-file-text-o"></i></span> Quản lý hồ sơ nhà máy</a>
         <hr />
                <!-- Dropdown menu footer -->
                <div class="drop-foot">
                  <a href="#">View All</a>
                </div>

              </li>
            </ul>
          </li>


        </ul>

        <!-- Search form -->
        <form class="navbar-form navbar-left" role="search">
			<div class="form-group">
				<input type="text" class="form-control" placeholder="Tìm kiếm nhanh">
			</div>
		</form>
        <!-- Links -->
        <ul class="nav navbar-nav pull-right">
          <li class="dropdown pull-right">            
            <a data-toggle="dropdown" class="dropdown-toggle" href="#">
              <i class="fa fa-user"></i> <span><?php if(isset($_SESSION['fullname'])){ echo $_SESSION['fullname'];} else { echo 'Người dùng';} ?> <b class="caret"></b>              
            </a>
            
            <!-- Dropdown menu -->
            <ul class="dropdown-menu">
              <li><a href="#"><i class="fa fa-user"></i> Hồ sơ</a></li>
              <li><a href="#"><i class="fa fa-cogs"></i> Settings</a></li>
              <li><a href="index.php?page=login"><i class="fa fa-sign-out"></i> <span class="userlogout">Đăng xuất</span></a></li>
            </ul>
          </li>
          
        </ul>
      </nav>

    </div>
  </div>


<!-- Header starts -->
  <header>
    <div class="container">
      <div class="row">
		<!-- buffer data -->
		<div class="col-md-3">	
		  <div class="logo">
            <h3><a href="#"><span class="bold">mdms.npc.com.vn</span></a></h3>
            <p class="meta">Quản lý các nhà máy thủy điện IPP</p>
          </div>
		</div>
		<div class="col-md-6">
          <div class="header-data">

            <!-- Traffic data -->
            <div class="hdata green_icon">
              <div class="mcol-left">
                <!-- Icon with red background -->
                <i class="fa fa-signal "></i> 
              </div>
              <div class="mcol-right">
                <!-- Number of visitors -->
				<span >Tổng số nhà máy: </span><span class="" style="font-weight:bold" ><span class="num_all_nmonline">--</span> </span> 				
              </div>
              <div class="clearfix"></div>
            </div>

            <!-- Members data -->
            <div class="hdata blue_icon">
              <div class="mcol-left">
                <!-- Icon with blue background -->
                <i class="fa fa-check-circle "></i> 
              </div>
              <div class="mcol-right">
                <!-- Number of visitors -->

				<span >Nhà máy Online: <span class="num_nmonline">--</span></span><span class="sub_online" style="font-weight:bold" > </span> 
              </div>
              <div class="clearfix"></div>
            </div>

            <!-- revenue data -->
            <div class="hdata red_icon">
              <div class="mcol-left">
                <!-- Icon with green background -->
                <i class="fa fa-check-circle-o  "></i> 
              </div>
              <div class="mcol-right">
                <!-- Number of visitors -->
                <span >Nhà máy Offline: <span class="num_nmoffline">--</span></span><span class="sub_offline" style="font-weight:bold" > 
              </div>
              <div class="clearfix"></div>
            </div>   
			

			
          </div>
        </div>
		<div class="col-md-3 header-data"  >	

                <p style="float:right; text-align:center"><a class="time_system"> </a> <em >Thời gian hệ thống: 12:41:00 18/3/2015 </em></p>

		</div>


        <!-- Data section -->



      </div>
    </div>
  </header>

<!-- Header ends -->

<!-- Main content starts -->

<div class="content">

  	<!-- Sidebar -->
    <div class="sidebar">
        <div class="sidebar-dropdown"><a href="#">Navigation</a></div>

        <!--- Sidebar navigation -->
        <!-- If the main navigation has sub navigation, then add the class "has_sub" to "li" of main navigation. -->
        <ul id="nav">
          <!-- Main menu with font awesome icon -->
          <li class="open"><a href="#"><i class="fa fa-home"></i> Dashboard</a>
            <!-- Sub menu markup 
            <ul>
              <li><a href="#">Submenu #1</a></li>
              <li><a href="#">Submenu #2</a></li>
              <li><a href="#">Submenu #3</a></li>
            </ul>-->
          </li>
          
        </ul>
    </div>

    <!-- Sidebar ends -->

  	  	<!-- Main bar -->
  	<div class="mainbar">
      
	    <!-- Page heading -->
	    <div class="page-head ">
	      <h2 class="pull-left name_sub_head" style="padding-right:5px;"></h2>
		    <ul class="today-datas page1_meter">
                <!-- List #1 -->
                <li>
                  <!-- Text -->
                  <div class="datas-text">12,000 visitors/day</div>
                </li>
                                                                                                                              
            </ul> 
        <div class="clearfix"></div>

	    </div>
	    <!-- Page heading ends -->



	    <!-- Matter -->

	    <div class="matter">
        <div class="container">

          <!-- Today status ends -->

          <!-- Dashboard Graph starts -->

          <div class="row">
            <div class="col-md-8">

              <!-- Widget -->
              <div class="widget">
                <!-- Widget head -->
                <div class="widget-head">
                  <div class="pull-left">Biểu đồ dòng điện</div>
                  <div class="widget-icons pull-right">
                    <a href="#" class="wminimize"><i class="fa fa-chevron-up"></i></a> 
                    <a href="#" class="wclose"><i class="fa fa-times"></i></a>
                  </div>  
                  <div class="clearfix"></div>
                </div>              

                <!-- Widget content -->
                <div class="widget-content">
					<div id="container1" style="min-width: 310px; height: 300px; margin: 0 auto"></div>
                </div>
                <!-- Widget ends -->

              </div>
            </div>

 <div class="col-md-4">
                <div class="widget" id="last_instant">

                <div class="widget-head">
                  <div class="pull-left">Thông số gần nhất: <span class="instant26" >15:20:00 18/3/2015</span></div>
                  <div class="widget-icons pull-right">
                    <a href="#" class="wminimize"><i class="fa fa-chevron-up"></i></a> 
                    <a href="#" class="wclose"><i class="fa fa-times"></i></a>
                  </div>  
                  <div class="clearfix"></div>
                </div>

                  <div class="widget-content">

					<div class="table-responsive">
						<table class="table table-striped table-bordered table-hover" style="height:300px">
						  <thead>
							<tr>
							  <th>Thông số</th>
							  <th>PhA</th>
							  <th>PhB</th>
							  <th>PhC</th>
							  <th>Sum</th>
							</tr>
						  </thead>
						  <tbody >

							<tr >
							  <td>U (V)</td>
							  <td class="instant1">-</td>
							  <td class="instant2">-</td>
							  <td class="instant3">-</td>
							  <td ><span class="label label-success instant" >-</span></td>

							</tr>


							<tr class="instanti">
							  <td >I (A)</td>
							  <td class="instant4">-</td>
							  <td class="instant5">-</td>
							  <td class="instant6">-</td>
							  <td ><span class="label label-success instant" >-</span></td>

							</tr>

							<tr class="instantf">
							  <td>F (Hz)</td>
							  <td class="instant7">-</td>
							  <td class="instant8">-</td>
							  <td class="instant9">-</td>
							  <td ><span class="label label-success instant" >-</span></td>

							</tr>

							<tr class="instantcos">
							  <td >Cosphi </td>
							  <td class="instant10">-</td>
							  <td class="instant11">-</td>
							  <td class="instant12">-</td>
							  <td ><span class="label label-success instant25" >-</span></td>

							</tr>

							<tr class="instantp">
							  <td >P (kW)</td>
							  <td class="instant13">-</td>
							  <td class="instant14">-</td>
							  <td class="instant15">-</td>
							  <td ><span class="label label-success instant22" >-</span></td>
		  
							</tr> 
							
							<tr class="instantq">
							  <td >Q (kVAr)</td>
							  <td class="instant16">-</td>
							  <td class="instant17">-</td>
							  <td class="instant18">-</td>
							  <td ><span class="label label-success instant23" >-</span></td>
		  
							</tr>                                                            						
							<tr class="instants">
							  <td >S (kVA)</td>
							  <td class="instant19">-</td>
							  <td class="instant20">-</td>
							  <td class="instant21">-</td>
							  <td ><span class="label label-success instant24" >-</span></td>
		  
							</tr>                                                            
						  </tbody>
						</table>
					</div>
                  </div>

                </div>
              </div>
          </div>
          <!-- Dashboard graph ends -->

          <!-- Chats, File upload and Recent Comments -->
          <div class="row">

            <div class="col-md-8">
              <!-- Widget -->
                            <div class="widget">

                <div class="widget-head">
                  <div class="pull-left">Biểu đồ điện áp</div>
                  <div class="widget-icons pull-right">
                    <a href="#" class="wminimize"><i class="fa fa-chevron-up"></i></a> 
                    <a href="#" class="wclose"><i class="fa fa-times"></i></a>
                  </div>  
                  <div class="clearfix"></div>
                </div>             

                <div class="widget-content">
                  <div class="padd">

						<div id="container2" style="min-width: 310px; height: 300px; margin: 0 auto"></div>

                  </div>
                </div>

              </div>
            </div>
			<div class="col-md-4">
                <div class="widget">

                <div class="widget-head">
                  <div class="pull-left">Chỉ số gần nhất: 15:20:00 18/3/2015</div>
                  <div class="widget-icons pull-right">
                    <a href="#" class="wminimize"><i class="fa fa-chevron-up"></i></a> 
                    <a href="#" class="wclose"><i class="fa fa-times"></i></a>
                  </div>  
                  <div class="clearfix"></div>
                </div>

                  <div class="widget-content">

					<div class="table-responsive">
						<table class="table table-striped table-bordered table-hover" style="height:300px">
						  <thead>
							<tr>
							  <th>Thông số</th>
							  <th>PhA</th>
							  <th>PhB</th>
							  <th>PhC</th>

							</tr>
						  </thead>
						  <tbody id="last_current">

							<tr>
							  <td>U (V)</td>
							  <td><span class="label label-danger">Banned</span></td>
							  <td>58,49</td>
							  <td><span class="label label-danger">Banned</span></td>

							</tr>


							<tr>
							  <td>I (A)</td>
							  <td><span class="label label-success">Banned</span></td>
							  <td>58,49</td>
							  <td><span class="label label-success">Banned</span></td>

							</tr>

							<tr>
							  <td>F (Hz)</td>
							  <td><span class="label label-danger">Banned</span></td>
							  <td>58,49</td>
							  <td><span class="label label-success">Banned</span></td>

							</tr>

							<tr>
							  <td>Cosphi </td>
							  <td><span class="label label-danger">Banned</span></td>
							  <td>58,49</td>
							  <td><span class="label label-success">Banned</span></td>

							</tr>

							<tr>
							  <td>P (kW)</td>
							  <td><span class="label label-danger">Banned</span></td>
							  <td>58,49</td>
							  <td><span class="label label-success">Banned</span></td>
		  
							</tr> 
								<tr>
							  <td>Q (kVAr)</td>
							  <td><span class="label label-danger">Banned</span></td>
							  <td>58,49</td>
							  <td><span class="label label-danger">Banned</span></td>
		  
							</tr>                                                            						
							<tr>
							  <td>S (kVA)</td>
							  <td><span class="label label-success">Banned</span></td>
							  <td>58,49</td>
							  <td><span class="label label-danger">Banned</span></td>
		  
							</tr>                                                            
						  </tbody>
						</table>
					</div>
                  </div>

                </div>
              </div>
		</div>
		<!-- Chats, File upload and Recent Comments -->
          <div class="row">

            <div class="col-md-8">
              <!-- Widget -->
                            <div class="widget">

                <div class="widget-head">
                  <div class="pull-left">Biểu đồ tần số</div>
                  <div class="widget-icons pull-right">
                    <a href="#" class="wminimize"><i class="fa fa-chevron-up"></i></a> 
                    <a href="#" class="wclose"><i class="fa fa-times"></i></a>
                  </div>  
                  <div class="clearfix"></div>
                </div>             

                <div class="widget-content">
                  <div class="padd">

						<div id="container3" style="min-width: 310px; height: 300px; margin: 0 auto"></div>

                  </div>
                </div>

              </div>
            </div>
		</div>

<!-- Content ends -->

<!-- Footer starts -->



<footer>
  <div class="container">
    <div class="row">
      <div class="col-md-12">
            <!-- Copyright info -->
            <p class="copy">Copyright &copy; 2012 | <a href="#">Your Site</a> </p>
      </div>
    </div>
  </div>
</footer> 	

<!-- Footer ends -->

<!-- Scroll to top -->
<span class="totop"><a href="#"><i class="fa fa-chevron-up"></i></a></span> 

<script src="js/jquery.js"></script> <!-- jQuery -->

<!-- Menu left + content Page 1 -->
<script>

      $('.navbar-nav a').click(function(){
          var path = '';
          if ($(this).hasClass('manager_instant_meter')){ 

              path = "<?php echo $page_template_path; ?>/manager_instant_meter.html";

          } else if ($(this).hasClass('manager_profile_meter')){ 

              path = "<?php echo $page_template_path; ?>/manager_profile_meter.html";

          } else if ($(this).hasClass('manager_current_meter')){ 

              path = "<?php echo $page_template_path; ?>/manager_current_meter.html";

          } else if ($(this).hasClass('manager_h1_meter')){ 

              path = "<?php echo $page_template_path; ?>/manager_h1_meter.html";

          } else if ($(this).hasClass('manager_sum_h1_meter')){ 

              path = "<?php echo $page_template_path; ?>/manager_sum_h1_meter.html";

          } else if ($(this).hasClass('manager_price')){ 

              path = "<?php echo $page_template_path; ?>/manager_price.html";

          } else if ($(this).hasClass('manager_dataipp')){ 

              path = "<?php echo $page_template_path; ?>/manager_dataipp.html";

          } else if ($(this).hasClass('manager_equipmentipp')){ 

              path = "<?php echo $page_template_path; ?>/manager_equipmentipp.html";

          } else if ($(this).hasClass('manager_fileipp')){ 

              path = "<?php echo $page_template_path; ?>/manager_fileipp.html";
          }

          if (path != ''){ 
            if ($(this).hasClass('doxa')){
              $('.sidebar').css('visibility','visible');
              $('.mainbar').css('margin-left','230px');
            } else if ($(this).hasClass('qlnm')) {
              $('.sidebar').css('visibility','hidden');
              $('.mainbar').css('margin-left','0px');
            }
            $('.matter').load(path); }

      });

      setInterval(function(){ checknnoline(<?php echo $userid; ?>, "<?php echo $token; ?>");}, 60000);

      var menu_left = <?php echo $menuleft; ?>;

      //console.log(<?php echo $userid.$token; ?>,'menu_left',menu_left);

        //$('.sub_online').html(data_content['online']);
        //$('.sub_offline').html(data_content['offline']);

        //var menu_left = data_content.data;
        $.each(menu_left, function(index, value){

          var sub = value[1];
          var html = '<ul class="list_sub">';
          $.each(sub, function(index, val){
            html +='<li data-id="'+val["id_sub"] +'"><a >'+val["name_sub"]+'</a></li>';
          });
          html +='</ul>';
          //console.log(value);
          $('#nav').append('<li class="has_sub">'+
                    '<a><i class="fa fa-list-alt"></i>'+value[0]["name_pwc"]+'<span class="pull-right"><i class="fa fa-chevron-right"></i></span></a>'+html+       
                  '</li>'); 
        });
      
        $(".list_sub > li").click(function(){
          //alert($(this).data('id'));
          page1_meter($(this).data('id'));
          $('.name_sub_head').html($(this).html());
          
        });
        $(".has_sub > a").click(function(e){
          e.preventDefault();
          var menu_li = $(this).parent("li");
          var menu_ul = $(this).next("ul");

          if(menu_li.hasClass("open")){
            menu_ul.slideUp(350);
            menu_li.removeClass("open")
          }
          else{
            $("#nav > li > ul").slideUp(350);
            $("#nav > li").removeClass("open");
            menu_ul.slideDown(350);
            menu_li.addClass("open");
          }
          });
      //console.log(menu_left);





    api_link='http://mdms.npc.com.vn/mdms2015/apis';

    checknnoline(<?php echo $userid; ?>, "<?php echo $token; ?>");

    function checknnoline(userid, token){
        $.ajax({
            url:api_link+'/nmonline.php',
            type:"POST",
            data:{id: userid, token: token},
            success:function(data){
                //console.log('e '+data);
                data = JSON.parse(data);
                $('.num_nmonline').html(data[0]);
                $('.num_nmoffline').html(data[1]);
                //alert((parseInt(data[0])+parseInt(data[1])));
                $('.num_all_nmonline').html((parseInt(data[0])+parseInt(data[1])));
            }, error: function(e){
                //console.log('e '+e);
            }
        
        }); 
    }
  	  
	var page1_meter = function(id_sub){
	
		$.ajax({
            url:api_link+'/page1_meter.php',
            type:"POST",
            data:{id_sub: id_sub},
            success:function(data){
			console.log(data);
               	$('.page1_meter').html('');
				 if (data !=0){
                    var meter = JSON.parse(data);
					var i= 0;
					$.each(meter, function(index, value){
					
					                
						$('.page1_meter').append('<li><div class="datas-text" id="meter'+i+'"><img src="img/meter.png" style="padding-right: 5px;"></img>'+ value['serial_meter']+'</div> </li>'); 
						i++;
					});
						//alert($("#meter0").text());
						chart($("#meter0").text());
					$(".page1_meter > li").click(function(){
						//alert($(this).text());
						chart($(this).text());
					});
				
                } else {
                    
                }
             }, error: function(e){
                console.log('e '+e);
            }
        
        }); 
	}	  
		/*  <li class="has_sub">
			<a href="#"><i class="fa fa-list-alt"></i> Điện lực Hòa Bình  <span class="pull-right"><i class="fa fa-chevron-right"></i></span></a>
            <ul>
              <li><a href="widgets1.html">TĐ Vạn Mai</a></li>
              <li><a href="widgets2.html">TĐ Vạn Mai</a></li>
              <li><a href="widgets3.html">TĐ Suối Tráng</a></li>
            </ul>
          </li>  	*/ 
</script>

<!-- Chart page 1 -->
<script>

function apply_thongso(data){
var i =1;
for (var key in data){
	var ttt = '#last_instant .instant'+i;
	$(ttt).html(data[key]);
	i++;
}
/*
	$.each($('#last_instant td'),function(index,val){
		if (!$(this).hasClass('label')) {
			$(this).html(data[index]);
		}
	});
*/	
}

//apply_thongso(mm);

var drawchart = function(dt,$this){
$this.highcharts({
//$('#container').highcharts({
        xAxis: {
		type: 'datetime',
						tickInterval: 3600 * 600, // one hour
						tickWidth: 0,
						gridLineWidth: 1,

     
				},
				tooltip: {
						
						shared: true,
						crosshairs: true,
						borderColor: '#058DC7',
						//formatter: function() {
				        //        return  Highcharts.dateFormat('%H:%M:%S', this.x) +': <b>'+ this.y + '</b>';
						//}
					},

				series: [{
					name: 'Ia',
					data: dt[0]
				},
				{
					name: 'Ib',
					data: dt[1]
				},
				{
					name: 'Ic',
					data: dt[2]
				}
				]
			});	
}


var chart = function(serial){
	//serial = '50817696';
	dt =[], dt0 =[], dt1 =[];
	$.ajax({
            url:api_link+'/page1_meter_chart.php',
            type:"POST",
            data:{serial: serial},
            success:function(data){
				//alert (data);
				temp = JSON.parse(data);
				dt=temp.dongdien;
				console.log('dttttttt',temp.thongso);

				drawchart(temp.dongdien,$('#container1'));
				drawchart(temp.dienap,$('#container2'));
				drawchart(temp.tanso,$('#container3'));
		//drawchart(temp.dienap);	
				
				apply_thongso(temp.thongso);
					
            }, error: function(e){
                console.log('e '+e);
            }
        
        }); 
}
	

</script>
<script src="js/highcharts.js"></script>
<script src="js/highstock.js"></script>
<script src="js/modules/exporting.js"></script>
<script src="js/Chart.js"></script> <!-- Charts & Graphs -->

<!-- JS -->

<script src="js/bootstrap.min.js"></script> <!-- Bootstrap -->
<script src="js/jquery-ui.min.js"></script> <!-- jQuery UI -->
<script src="js/fullcalendar.min.js"></script> <!-- Full Google Calendar - Calendar -->
<script src="js/jquery.rateit.min.js"></script> <!-- RateIt - Star rating -->
<script src="js/jquery.prettyPhoto.js"></script> <!-- prettyPhoto -->
<script src="js/jquery.slimscroll.min.js"></script> <!-- jQuery Slim Scroll -->
<script src="js/jquery.dataTables.min.js"></script> <!-- Data tables -->

<!-- jQuery Flot -->
<script src="js/excanvas.min.js"></script>
<script src="js/jquery.flot.js"></script>
<script src="js/jquery.flot.resize.js"></script>
<script src="js/jquery.flot.pie.js"></script>
<script src="js/jquery.flot.stack.js"></script>

<!-- jQuery Notification - Noty -->
<!--script src="js/jquery.noty.js"></script>  jQuery Notify -->
<script src="js/themes/default.js"></script> <!-- jQuery Notify -->
<script src="js/layouts/bottom.js"></script> <!-- jQuery Notify -->
<script src="js/layouts/topRight.js"></script> <!-- jQuery Notify -->
<script src="js/layouts/top.js"></script> <!-- jQuery Notify -->
<!-- jQuery Notification ends -->

<script src="js/sparklines.js"></script> <!-- Sparklines -->
<script src="js/jquery.cleditor.min.js"></script> <!-- CLEditor -->
<script src="js/bootstrap-datetimepicker.min.js"></script> <!-- Date picker -->
<script src="js/jquery.onoff.min.js"></script> <!-- Bootstrap Toggle -->
<script src="js/filter.js"></script> <!-- Filter for support page -->
<script src="js/custom.js"></script> <!-- Custom codes -->


<!-- Script for this page -->

<script type="text/javascript">
$(function () {

    /* Bar Chart starts */

    var d1 = [];
    for (var i = 0; i <= 20; i += 1)
        d1.push([i, parseInt(Math.random() * 30)]);

    var d2 = [];
    for (var i = 0; i <= 20; i += 1)
        d2.push([i, parseInt(Math.random() * 30)]);


    var stack = 0, bars = true, lines = false, steps = false;
    
    function plotWithOptions() {
        $.plot($("#bar-chart"), [ d1, d2 ], {
            series: {
                stack: stack,
                lines: { show: lines, fill: true, steps: steps },
                bars: { show: bars, barWidth: 0.8 }
            },
            grid: {
                borderWidth: 0, hoverable: true, color: "#777"
            },
            colors: ["#ff6c24", "#ff2424"],
            bars: {
                  show: true,
                  lineWidth: 0,
                  fill: true,
                  fillColor: { colors: [ { opacity: 0.9 }, { opacity: 0.8 } ] }
            }
        });
    }

    plotWithOptions();
    
    $(".stackControls input").click(function (e) {
        e.preventDefault();
        stack = $(this).val() == "With stacking" ? true : null;
        plotWithOptions();
    });
    $(".graphControls input").click(function (e) {
        e.preventDefault();
        bars = $(this).val().indexOf("Bars") != -1;
        lines = $(this).val().indexOf("Lines") != -1;
        steps = $(this).val().indexOf("steps") != -1;
        plotWithOptions();
    });

    /* Bar chart ends */

});


/* Curve chart starts */

$(function () {
    var sin = [], cos = [];
    for (var i = 0; i < 14; i += 0.5) {
        sin.push([i, Math.sin(i)]);
        cos.push([i, Math.cos(i)]);
    }

    var plot = $.plot($("#curve-chart"),
           [ { data: sin, label: "sin(x)"}, { data: cos, label: "cos(x)" } ], {
               series: {
                   lines: { show: true, fill: true},
                   points: { show: true }
               },
               grid: { hoverable: true, clickable: true, borderWidth:0 },
               yaxis: { min: -1.2, max: 1.2 },
               colors: ["#1eafed", "#1eafed"]
             });

    function showTooltip(x, y, contents) {
        $('<div id="tooltip">' + contents + '</div>').css( {
            position: 'absolute',
            display: 'none',
            top: y + 5,
            left: x + 5,
            border: '1px solid #000',
            padding: '2px 8px',
            color: '#ccc',
            'background-color': '#000',
            opacity: 0.9
        }).appendTo("body").fadeIn(200);
    }

    var previousPoint = null;
    $("#curve-chart").bind("plothover", function (event, pos, item) {
        $("#x").text(pos.x.toFixed(2));
        $("#y").text(pos.y.toFixed(2));

        if ($("#enableTooltip:checked").length > 0) {
            if (item) {
                if (previousPoint != item.dataIndex) {
                    previousPoint = item.dataIndex;
                    
                    $("#tooltip").remove();
                    var x = item.datapoint[0].toFixed(2),
                        y = item.datapoint[1].toFixed(2);
                    
                    showTooltip(item.pageX, item.pageY, 
                                item.series.label + " of " + x + " = " + y);
                }
            }
            else {
                $("#tooltip").remove();
                previousPoint = null;            
            }
        }
    }); 

    $("#curve-chart").bind("plotclick", function (event, pos, item) {
        if (item) {
            $("#clickdata").text("You clicked point " + item.dataIndex + " in " + item.series.label + ".");
            plot.highlight(item.series, item.datapoint);
        }
    });

});

/* Curve chart ends */
</script>
</body>
</html>